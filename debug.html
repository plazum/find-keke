<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="author" content="https://github.com/plazum/find-keke">
    <style>
      body {
        text-align: center;
        margin: 0;
      }
      div {
        display: grid;
      }
      table {
        border-collapse: collapse;
      }
      tr {
        display: flex;
        background-image: url(image-background.png);
      }
      td {
        display: contents;
      }
      input:invalid {
        border: 2px dashed red;
      }
      input[type="radio"], input[type="checkbox"] {
        transform: scale(1.2);
      }
      input[type="number"] {
        width: 3em;
        font-size: large;
        margin-right: 0.25em;
      }
      button {
        font-size: large;
      }
    </style>
    <link rel="icon" href="fu.png">
    <script>
      "use strict";
      let time, d, time_string, last_rows, last_cols, hinted, language = navigator.language.substring(0, 2).toLowerCase();
      const dialog_supported = "showModal" in document.createElement("dialog");
      console.log("%c ", "display: inline-block; padding: 37.5px 37.5px; background: url(https://zrtech.org/find-keke/keke.jpg) no-repeat;");
      console.log("æ˜¯çœŸçš„");

      function show_bubu() {
        if (document.getElementById("result").style.display !== "none")
          return;
        document.getElementById("bubu").style.display = "";
        document.getElementById("bubu_video").play();
        window.scrollTo({top: 0, behavior: "smooth"});
      }

      function bainian() {
        if (dialog_supported) {
          document.getElementById("bainian").showModal();
        } else {
          document.getElementById("bainian").setAttribute("open", "");
          document.getElementById("bainian").setAttribute("modal", "");
        }
      }

      function close_bainian() {
        if (dialog_supported) {
          document.getElementById("bainian").close();
        } else {
          document.getElementById("bainian").removeAttribute("open", "");
          document.getElementById("bainian").removeAttribute("modal", "");
        }
      }

      function start_timing() {
        time = Date.now();
      }

      // ä»ä»¥10æ¯«ç§’ä¸ºå•ä½çš„æ•´æ•°è½¬æ¢æˆä»¥ç§’ä¸ºå•ä½çš„ç²¾ç¡®åˆ°ä¸¤ä½å°æ•°çš„å­—ç¬¦ä¸²
      function time_to_string(time) {
        let time_string = (time / 100).toString();
        if (time % 100 === 0)
          time_string += ".00";
        else if (time % 10 === 0)
          time_string += "0";
        return time_string;
      }

      function write_result() {
        if (!hinted) {
          if (time <= 300) {
            const text1 = {
              zh: `ï¼ˆè°ƒè¯•ç”¨ï¼‰æ­å–œä½ åœ¨ä¸‰ç§’å†…æ‰¾åˆ°äº†å”å¯å¯ï¼ç”¨æ—¶${time_string}ç§’ã€‚`,
              ja: `ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ä¸‰ç§’ä»¥å†…ã§å”å¯å¯ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚${time_string}ç§’ã‹ã‹ã‚Šã¾ã—ãŸã€‚`,
              en: `(Debug) Congratulations! You have found Tang Keke within three seconds. ${time_string} seconds taken.`
            };
            document.getElementById("time1").innerHTML = text1[language];
            document.getElementById("niubi").style.display = "";
          } else {
            const text2 = {
              zh: `ï¼ˆè°ƒè¯•ç”¨ï¼‰æ­å–œä½ æ‰¾åˆ°äº†å”å¯å¯ï¼ç”¨æ—¶${time_string}ç§’ã€‚`,
              ja: `ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å”å¯å¯ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚${time_string}ç§’ã‹ã‹ã‚Šã¾ã—ãŸã€‚`,
              en: `(Debug) Congratulations! You have found Tang Keke. ${time_string} seconds taken.`
            };
            document.getElementById("time2").innerHTML = text2[language];
            document.getElementById("time2").style.display = "";
          }
        } else {
          const text3 = {
            zh: `ï¼ˆè°ƒè¯•ç”¨ï¼‰ç»è¿‡æç¤ºï¼Œä½ ç»ˆäºåœ¨${time_string}ç§’çš„æ—¶å€™æ‰¾åˆ°äº†å”å¯å¯ã€‚`,
            ja: `ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰ãƒ’ãƒ³ãƒˆã‚’ä½¿ã£ã¦ã€${time_string}ç§’ã§ã‚ˆã†ã‚„ãå”å¯å¯ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚`,
            en: `(Debug) You have finally found Tang Keke after hinted at the ${time_string}th second.`
          };
          document.getElementById("time2").innerHTML = text3[language];
          document.getElementById("time2").style.display = "";
        }
      }

      function finish() {
        d = new Date();
        if (document.getElementById("result").style.display !== "none")
          return;
        time = d.getTime() - time;
        time = Math.floor(time / 10);
        // åˆ¤æ–­ä»»æ„æ£‹ç›˜å¤§å°ä¸‹çš„ç”¨æ—¶ç­‰æ•ˆå°äºç­‰äº3ç§’çš„è§„åˆ™ä¸º(time / (rows * cols)) <= (3 / (14 * 10))
        // æ³¨æ„æ­¤å¤„å•ä½ä¸º10æ¯«ç§’
        const in_time_limit = time * 14 * 10 <= 300 * last_rows * last_cols;
        time_string = time_to_string(time);
        write_result();
        document.getElementById("result").style.display = "";
        document.getElementById("good_video").play();
        document.getElementById("bubu").style.display = "none";
        document.getElementById("keke").style.filter = "drop-shadow(2px 4px 6px black)";
        document.getElementById("hint").setAttribute("disabled", "");
        document.getElementById("scoreboard").style.display = "none";
        setTimeout(() => window.scrollTo({top: 0, behavior: "smooth"}), 1);
        // if (!hinted && in_time_limit)
        //   upload_score();
      }

      function generate_map(rows, cols) {
        let board = [];
        let content = "";
        let selected = [];

        for (let i = 0; i < image.length; i++) {
          if (document.getElementById(i.toString()).checked) {
            selected.push(image[i].filename);
          }
        }
        if (selected.length === 0)
          return;

        reset();
        last_rows = rows;
        last_cols = cols;
        const x = Math.floor(Math.random() * rows);
        const y = Math.floor(Math.random() * cols);
        for (let i = 0; i < rows; i++) {
          board[i] = Array.from({length: cols}, () => Math.floor(Math.random() * selected.length));
        }
        for (let i = 0; i < rows; i++) {
          content += "<tr>";
          for (let j = 0; j < cols; j++) {
            content += "<td>" + (i === x && j === y ?
              '<img id="keke" onclick="finish()" src="keke.jpg">'
              :
              (selected[board[i][j]] === "fu.png" ?
                '<img onclick="bainian()" src="fu.png"' + (Math.random() < 0.5 ? ' style="transform: rotate(180deg);"' : '') + '>'
                :
                '<img onclick="finish()" src="' + selected[board[i][j]] + '">'
              )
            ) + "</td>";
          }
          content += "</tr>";
        }
        document.getElementById("banner").style.width = Math.max(cols * 75, 750) + "px";
        document.getElementById("map").innerHTML = content;
        start_timing();
      }

      function reset() {
        document.getElementById("result").style.display = "none";
        document.getElementById("niubi").style.display = "none";
        document.getElementById("time2").style.display = "none";
        document.getElementById("bubu").style.display = "none";
        document.getElementById("upload_status").style.display = "none";
        document.getElementById("scoreboard").style.display = "";
        document.getElementById("good_video").pause();
        document.getElementById("bubu_video").pause();
        document.getElementById("hint").removeAttribute("disabled");
        hinted = false;
      }

      function hint() {
        document.getElementById("keke").style.filter = "drop-shadow(2px 4px 6px black)";
        document.getElementById("hint").setAttribute("disabled", "");
        hinted = true;
      }

      function get_token() {
        let e = "!W|!Z)!k*!F{!qN u%!/V!oB!3n!oB B\" B\" lT!+>!)2!`M!M@!)2 pl Pv!h}!`M!\\5 }U L^ S# Nj!:3 rx!bY!K4 y=!K4!sZ F: y=!Up!Up!bY!~7", d = "";
        for (let i = 0; i < e.length / 3; i++) d += String.fromCharCode(((e.charCodeAt(i * 3) - " ".charCodeAt(0)) * 9025 + (e.charCodeAt(i * 3 + 1) - " ".charCodeAt(0)) * 95 + (e.charCodeAt(i * 3 + 2) - " ".charCodeAt(0))) / (new Error()).stack.split(":")[2 + isNaN((new Error()).stack.split(":")[2])] + " ".charCodeAt(0));
        return d;
      }

      const placeholder = {
        zh: ["æ¶©è°·é¦™éŸ³", "å”å¯å¯", "å²šåƒç ‚éƒ½", "å¹³å®‰åå ‡", "å¶æœˆæ‹", "åœ£æ³½æ‚ å¥ˆ", "æŸŠæ‘©å¤®"],
        ja: ["æ¾è°·ã‹ã®ã‚“", "å”å¯å¯", "åµåƒç ‚éƒ½", "å¹³å®‰åã™ã¿ã‚Œ", "è‘‰æœˆæ‹", "è–æ¾¤æ‚ å¥ˆ", "æŸŠæ‘©å¤®"],
        en: ["Shibuya Kanon", "Tang Keke", "Arashi Chisato", "Heanna Sumire", "Hazuki Ren", "Hijirisawa Yuuna", "Hiiragi Mao"]
      };
      let name_default, name_safe_for_html;

      function write_upload_status() {
        const text_uploaded = {
          zh: `åˆ†æ•°å·²ä¸Šä¼ ï¼š${name_safe_for_html}ï¼›${last_rows}è¡ŒÃ—${last_cols}åˆ—ï¼›ç”¨æ—¶${time_string}ç§’<br>${d}`,
          ja: `ç‚¹æ•°ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼š${name_safe_for_html}ï¼›${last_rows}è¡ŒÃ—${last_cols}åˆ—ï¼›${time_string}ç§’ã‹ã‹ã‚Šã¾ã—ãŸ<br>${d}`,
          en: `Score uploaded: ${name_safe_for_html}; ${last_rows} rows Ã— ${last_cols} columns; ${time_string} seconds taken<br>${d}`
        };
        document.getElementById("upload_status").innerHTML = text_uploaded[language];
      }

      async function upload_score() {
        const time_limit = Math.floor(300 * last_rows * last_cols / (14 * 10));
        const time_limit_string = time_to_string(time_limit);
        const text_prompt = {
          zh: "æ­å–œä½ æœ¬æ¬¡çš„ç­‰æ•ˆç”¨æ—¶å°äºæˆ–ç­‰äº3ç§’ï¼\n"
            + "ï¼ˆç­‰æ•ˆç”¨æ—¶æŒ‡çš„æ˜¯å°†ç”¨æ—¶æŒ‰ç…§æ£‹ç›˜å¤§å°æŒ‰æ¯”ä¾‹æŠ˜ç®—æˆ14Ã—10æ£‹ç›˜ä¹‹åçš„æ—¶é—´ã€‚ï¼‰\n"
            + `ï¼ˆæœ¬æ¬¡ç”¨æ—¶ä¸º${time_string}ç§’ï¼Œæ£‹ç›˜å¤§å°ä¸º${last_rows}Ã—${last_cols}ï¼Œ`
            + `æƒ³è¦ä½¿ç­‰æ•ˆç”¨æ—¶å°äºæˆ–ç­‰äº3ç§’ï¼Œä½ çš„ç”¨æ—¶å¿…é¡»å°äºæˆ–ç­‰äº${time_limit_string}ç§’ã€‚ï¼‰\n\n`
            + "è¯·è¾“å…¥ä½ çš„ç©å®¶åï¼ˆå¦‚æœä¸æƒ³ä¸Šä¼ åˆ†æ•°ï¼Œè¯·ç‚¹å‡»å–æ¶ˆæˆ–ç•™ç©ºï¼‰",
          ja: "ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ç­‰ä¾¡æ™‚é–“ã¯3ç§’ä»¥ä¸‹ã§ã™ã€‚\n"
            + "ï¼ˆç­‰ä¾¡æ™‚é–“ã¨ã„ã†ã®ã¯ã€ã‹ã‹ã£ãŸæ™‚é–“ã«ãƒœãƒ¼ãƒ‰ã®ã‚µã‚¤ã‚ºã«å¯¾ã™ã‚‹14Ã—10ãƒœãƒ¼ãƒ‰ã®ã‚µã‚¤ã‚ºã®æ¯”ç‡ã‚’ã‹ã‘ãŸæ™‚é–“ã§ã™ã€‚ï¼‰\n"
            + `ï¼ˆä»Šå›ã‹ã‹ã£ãŸæ™‚é–“ã¯${time_string}ç§’ã€ãƒœãƒ¼ãƒ‰ã®ã‚µã‚¤ã‚ºã¯${last_rows}Ã—${last_cols}ã§ã€`
            + `ç­‰ä¾¡æ™‚é–“ãŒ3ç§’ä»¥ä¸‹ã«ãªã‚‹å ´åˆã€ã‹ã‹ã£ãŸæ™‚é–“ãŒ${time_limit_string}ç§’ä»¥ä¸‹ã«ãªã‚‰ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ï¼‰\n\n`
            + "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆã‚‚ã—ç‚¹æ•°ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸããªã„ãªã‚‰ã€ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã€ã‚ã‚‹ã„ã¯å…¥åŠ›ã—ãªã„ã§ãã ã•ã„ï¼‰",
          en: "Congratulations! The time you spent is equivalently less than or equal to 3 seconds.\n"
            + "(The equivalently-taken time means the time you spent after proportionally converting the board to the 14Ã—10 board based on the board size.)\n"
            + `(You have spent ${time_string} seconds, and the board size is ${last_rows}Ã—${last_cols}, `
            + `so in order to make the time you spent equivalently less than or equal to 3 seconds, you must spend less than or equal to ${time_limit_string} seconds.)\n\n`
            + "Please input you player name (or click Cancel or leave it empty if you do not want to upload your score)"
        };
        let name = prompt(text_prompt[language], name_default);
        if (name == null)
          return;
        name = name.trim();
        if (name === "")
          return;

        name_default = name;
        name_safe_for_html = name.replace(/</g, "&lt;").replace(/>/g, "&gt;"); // é˜²æ­¢ç”¨æˆ·è¾“å…¥HTMLä»£ç 
        name = name_safe_for_html.replace(/%/g, "&#37;")
          .replace(/\\/g, "\\\\")
          .replace(/\|/g, "\\|"); // é˜²æ­¢ç”¨æˆ·è¾“å…¥Markdownè¡¨æ ¼åˆ†åˆ—ç¬¦ã€åæ–œæ å’Œç™¾åˆ†å·
        upload_score.text_uploading = upload_score.text_uploading || {
          zh: "ä¸Šä¼ ä¸­ï¼Œè¯·ç¨å€™â€¦â€¦",
          ja: "ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­ã§ã™ã€‚ãŠå¾…ã¡ãã ã•ã„â€¦",
          en: "Please wait while uploadingâ€¦"
        }; // æ¨¡æ‹Ÿé™æ€å±€éƒ¨å˜é‡
        document.getElementById("upload_status").innerHTML = upload_score.text_uploading[language];
        document.getElementById("upload_status").style.display = "";
        const data = {
          ref: "master",
          inputs: {
            player_name: name,
            rows: last_rows.toString(),
            cols: last_cols.toString(),
            score: time_string,
            time: d.toString()
          }
        };

        let retry = true;
        do {
          let fetch_fail = false;
          const response = await fetch(
            "https://api.github.com/repos/plazum/find-keke/actions/workflows/add-score.yml/dispatches",
            {
              method: "POST",
              headers: {
                Accept: "application/vnd.github.v3+json",
                Authorization: "token " + get_token()
              },
              body: JSON.stringify(data)
            }
          )
            .catch(error => {
              fetch_fail = true;
              const text_fetch_error = {
                zh: `Fetch APIæŠ›å‡ºé”™è¯¯â€œ${error}â€ï¼Œæ˜¯å¦é‡è¯•ï¼Ÿ`,
                ja: `Fetch APIã«ã€Œ${error}ã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å†è©¦è¡Œã—ã¾ã™ã‹ï¼Ÿ`,
                en: `Fetch API throws error "${error}", retry?`
              };
              retry = confirm(text_fetch_error[language]);
            });
          if (fetch_fail) {
            if (retry)
              continue;
            else
              break;
          }

          const text = await response.text();
          if (response.ok) {
            write_upload_status();
            const text_github_rest_api_succeeded = {
              zh: `ä¸Šä¼ æˆåŠŸï¼\nGitHub REST APIè¿”å›å¦‚ä¸‹\n${response.status} ${response.statusText}\n${text}`,
              ja: `ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸã—ã¾ã—ãŸï¼\nGitHub REST APIã®æˆ»ã‚Šå€¤ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™\n${response.status} ${response.statusText}\n${text}`,
              en: `Successfully uploaded! \nGitHub REST API returns as follows\n${response.status} ${response.statusText}\n${text}`
            };
            alert(text_github_rest_api_succeeded[language]);
            break;
          } else {
            const text_github_rest_api_failed = {
              zh: `GitHub REST APIå¤±è´¥ï¼Œè¿”å›å¦‚ä¸‹\n${response.status} ${response.statusText}\n${text}æ˜¯å¦é‡è¯•ï¼Ÿ`,
              ja: `GitHub REST APIãŒå¤±æ•—ã—ã¾ã—ãŸã€‚æˆ»ã‚Šå€¤ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™\n${response.status} ${response.statusText}\n${text}å†è©¦è¡Œã—ã¾ã™ã‹ï¼Ÿ`,
              en: `GitHub REST API fails, returning as follows\n${response.status} ${response.statusText}\n${text}Retry?`
            };
            retry = confirm(text_github_rest_api_failed[language]);
          }
        } while (retry);
        if (document.getElementById("upload_status").innerHTML === upload_score.text_uploading[language])
          document.getElementById("upload_status").style.display = "none";
      }

      const UI_text = {
        title: {
          zh: "å¯»æ‰¾å”å¯å¯ï¼ˆè°ƒè¯•ç”¨ï¼‰",
          ja: "å”å¯å¯ã‚’æ¢ã›ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰",
          en: "Find out Tang Keke (Debug)"
        },
        scoreboard: {
          zh: "æŸ¥çœ‹è®¡åˆ†æ¿å’Œæœ€é«˜çºªå½•â†—",
          ja: "ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰ã¨æœ€é«˜è¨˜éŒ²â†—",
          en: "See the scoreboard and top recordsâ†—"
        },
        classic_mode: {
          zh: "ç»å…¸æ¨¡å¼14Ã—10",
          ja: "ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰14Ã—10",
          en: "Classic Mode 14Ã—10"
        },
        extended_mode: {
          zh: "æ‰©å±•æ¨¡å¼14Ã—14",
          ja: "åºƒãŒã‚Šãƒ¢ãƒ¼ãƒ‰14Ã—14",
          en: "Extended Mode 14Ã—14"
        },
        hard_mode: {
          zh: "å›°éš¾æ¨¡å¼20Ã—14",
          ja: "å›°é›£ãƒ¢ãƒ¼ãƒ‰20Ã—14",
          en: "Hard Mode 20Ã—14"
        },
        row: {
          zh: "è¡Œ",
          ja: "è¡Œ",
          en: "Rows"
        },
        column: {
          zh: "åˆ—",
          ja: "åˆ—",
          en: "Columns"
        },
        customize_mode: {
          zh: "è‡ªå®šä¹‰æ¨¡å¼",
          ja: "ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰",
          en: "Customize Mode"
        },
        hint: {
          zh: "æ¥ç‚¹æç¤º",
          ja: "ãƒ’ãƒ³ãƒˆé ‚æˆ´",
          en: "Hint"
        },
        debug: {
          zh: "æƒ³è¦ä¸€å‡»å¿…èƒœï¼Ÿç‚¹æ­¤å‰å¾€è°ƒè¯•æ¨¡å¼",
          ja: "ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å‹ã¡ãŸã„ï¼Ÿã“ã“ã«ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã¸",
          en: "Want to win at a single click? Click here for Debug Mode"
        },
        new_game: {
          zh: "å†æ¥ä¸€å±€",
          ja: "ã‚‚ã†ä¸€å›",
          en: "New Game"
        },
        github: {
          zh: "æ¥GitHubä¸Šåˆ‡å…‹é—¹ï¼ˆæŒ‡check it outï¼‰å§â†—",
          ja: "GitHubã§ãƒã‚§ã‚±ãƒ©ãƒƒï¼ˆcheck it outï¼‰â†—",
          en: "Check it out on GitHubâ†—"
        },
        wrong: {
          zh: "ä¸æ˜¯è¿™ä¸ªå“¦ï¼Œè¯·å†è¯•ä¸€æ¬¡ã€‚",
          ja: "é–“é•ã£ãŸã‚ˆã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚",
          en: "Wrong. Please try again."
        },
        give_up: {
          zh: "ç´¯äº†ï¼Œæˆ‘è¦é‡å¼€ï¼ˆæŒ‡æ¸¸æˆï¼‰",
          ja: "ã‚‚ã†ã„ã„ã€ã‚„ã‚Šç›´ã—ã ",
          en: "Give Up and New Game"
        }
      };

      function set_language(value) {
        language = value;

        const UI = [
          "scoreboard", "classic_mode", "extended_mode", "hard_mode",
          "row", "column", "customize_mode", "hint",
          "new_game", "github", "wrong", "give_up"
        ];
        document.title = UI_text.title[language];
        for (let i = 0; i < UI.length; i++) {
          document.getElementById(UI[i]).innerHTML = UI_text[UI[i]][language];
        }
        document.getElementById("scoreboard2").innerHTML = UI_text.scoreboard[language];
        if (document.getElementById("debug"))
          document.getElementById("debug").title = UI_text.debug[language];
        for (let i = 0; i < image.length; i++) {
          document.getElementById("label_" + i).innerHTML = image[i].name[language];
        }
        name_default = location.href.startsWith("https://zrtech.org/") ?
          placeholder[language][Math.floor(Math.random() * placeholder.zh.length)]
          :
          "testï¼ˆæœ¬åœ°å¼€å‘æµ‹è¯•ç”¨ï¼‰"
        ;
        if (document.getElementById("result").style.display !== "none")
          write_result();
        if (document.getElementById("upload_status").style.display !== "none")
          write_upload_status();
      }
    </script>
  </head>
  <body>
    <div>
      <div id="result" style="display: none;">
        <table id="niubi" style="display: none; margin: 1em auto 1em auto;">
          <tr style="background-image: none;">
            <td><h1 id="time1" style="margin: auto;"></h1></td>
            <td><img src="niubi.jpg" width="203" height="103"></td>
          </tr>
        </table>
        <h1 id="time2" style="display: none;"></h1>
        <h1 id="upload_status" style="display: none;"></h1>
        <button id="new_game" style="margin: 0 auto 0 auto; font-size: x-large;" onclick="generate_map(last_rows, last_cols)">
        </button>
        <a id="scoreboard2" style="margin: 1em auto 0.5em auto; font-size: larger;" href="https://github.com/plazum/find-keke/issues/5" target="_blank">
        </a>
        <a id="github" style="margin: 0 auto 1.5em auto;" href="https://github.com/plazum/find-keke" target="_blank">
        </a>
        <video id="good_video" style="margin: auto;" src="good.mp4" loop></video>
      </div>
      <div id="bubu" style="display: none;">
        <h1 id="wrong"></h1>
        <button id="give_up" style="margin: auto auto 1em auto; font-size: x-large;" onclick="generate_map(last_rows, last_cols)">
        </button>
        <video id="bubu_video" style="margin: auto;" src="bubu.mp4" loop></video>
      </div>
      <div style="margin: 1.5em auto 1.25em auto; font-size: larger;">
        <div style="display: block; margin-bottom: 0.5em;">
          <label><input id="zh" type="radio" name="language" onchange="set_language('zh')">ä¸­æ–‡</label>
          <label><input id="ja" type="radio" name="language" onchange="set_language('ja')">æ—¥æœ¬èª</label>
          <label><input id="en" type="radio" name="language" onchange="set_language('en')">English</label>
        </div>
        <a id="scoreboard" style="margin: 0 auto 0.5em auto;" href="https://github.com/plazum/find-keke/issues/5" target="_blank">
        </a>
        <div style="display: block; margin-bottom: 0.75em;" id="filter"></div>
        <div style="display: block;">
          <button id="classic_mode" onclick="generate_map(14, 10)"></button>
          <button id="extended_mode" onclick="generate_map(14, 14)"></button>
          <button id="hard_mode" onclick="generate_map(20, 14)"></button>
          <form style="display: inline-block;"
                onsubmit="generate_map(document.getElementById('rows').value, document.getElementById('cols').value); return false;">
            <input id="rows" type="number" value="20" min="1" required><label id="row" for="rows"></label>
            Ã—
            <input id="cols" type="number" value="20" min="1" required><label id="column" for="cols"></label>
            <button id="customize_mode" type="submit"></button>
          </form>
          <button id="hint" onclick="hint()"></button>
        </div>
      </div>
      <div id="banner" style="margin: auto; background-image: url(banner-extension.jpg);">
        <img style="margin: auto;" src="banner.jpg">
      </div>
      <table id="map" style="margin: auto;">
      </table>
    </div>
    <dialog id="bainian" style="padding: 0 0 1em 0;">
      <div style="color: yellow; background-color: red; padding: 0 2em 0 2em; margin-bottom: 1em;">
        <h1>æœ¬æ¸¸æˆå¼€å‘è€…æ­ç¥å„ä½ç©å®¶æ–°æ˜¥å¤§å‰ï¼</h1>
      </div>
      <button style="font-size: 300px;" onclick="close_bainian()">ğŸ§§</button>
    </dialog>
    <div class="backdrop" style="z-index: 10000;"></div>
    <script>
      // åœ¨æ­¤å¤„æ·»åŠ è§’è‰²ä¿¡æ¯
      const image = [
        {
          filename: "kotori.jpg",
          name: {
            zh: "å—å°é¸Ÿ",
            ja: "å—ã“ã¨ã‚Š",
            en: "Minami Kotori"
          }
        },
        {
          filename: "you.jpg",
          name: {
            zh: "æ¸¡è¾¹æ›œ",
            ja: "æ¸¡è¾ºæ›œ",
            en: "Watanabe You"
          }
        },
        {
          filename: "fu.png",
          name: {
            zh: "ç¦",
            ja: "ç¦",
            en: "Fu (ç¦)"
          }
        },
      ];
      document.getElementById("filter").innerHTML = image.map(
        (val, idx) => '<input id="' + idx + '" type="checkbox" checked onchange="generate_map(last_rows, last_cols)">'
          + '<label id="label_' + idx + '" for="' + idx + '"></label>'
      ).join(" ");
      if (!["zh", "ja", "en"].includes(language))
        language = "en";
      document.getElementById(language).click();
      set_language(language);
      if (!dialog_supported) {
        document.head.innerHTML += '<link rel="stylesheet" href="dialog.css">';
        document.getElementById("bainian").style.zIndex = "10001";
      }

      generate_map(14, 10);
    </script>
  </body>
</html>
